services:
  alexa_api:
    build:
      context: .
      dockerfile: Dockerfile # Use the new Dockerfile at the root
    container_name: shopping_list_api
    ports:
      # Map host port 8000 to container port 8000 (which is defined in src/api/config.py)
      - "8000:8000"
    volumes:
      # Use a named volume for persistent data (e.g., cookies)
      - cookie_data:/app/data
    # Healthcheck to ensure the application is running
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/"] # Use the root endpoint
      interval: 30s
      timeout: 10s
      retries: 3
    # Optional: Resource limits (uncomment if needed)
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '1'
    #       memory: 512M
    restart: unless-stopped

# Declare the named volume used by the service
volumes:
  cookie_data:
